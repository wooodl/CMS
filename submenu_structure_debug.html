<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­èœå•ç»“æ„è°ƒè¯•é¡µé¢</title>
    <link rel="stylesheet" href="wwwroot/lib/layui/css/layui.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
        }
        
        /* è°ƒè¯•ä¿¡æ¯é¢æ¿ */
        .debug-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 400px;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 15px;
            z-index: 100000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            font-size: 11px;
            max-height: 85vh;
            overflow-y: auto;
        }
        
        .debug-panel h4 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 14px;
        }
        
        .debug-buttons button {
            margin: 2px;
            padding: 4px 8px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 10px;
        }
        
        .btn-red { background: #FF4444; color: white; }
        .btn-blue { background: #4444FF; color: white; }
        .btn-green { background: #44AA44; color: white; }
        .btn-orange { background: #FF8844; color: white; }
        
        /* æ”¶ç¼©çŠ¶æ€ä¸‹çš„å­èœå•æ ·å¼ - ç®€åŒ–ç‰ˆæœ¬ */
        .layui-layout-admin.layui-layout-shrink .layui-nav-tree .layui-nav-child {
            display: none !important;
        }

        /* å¼ºåˆ¶æ˜¾ç¤ºå­èœå•çš„ç±» */
        .layui-nav-child.show-submenu {
            display: block !important;
            position: fixed !important;
            z-index: 99999 !important;
            background-color: #2F4056 !important;
            border-radius: 2px !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
            min-width: 160px !important;
            border: 1px solid #393D49 !important;
            opacity: 1 !important;
            visibility: visible !important;
            pointer-events: auto !important;
        }
        
        /* è°ƒè¯•æ ·å¼ - æ˜¾ç¤ºè¾¹ç•Œ */
        .debug-border {
            border: 2px solid #FF0000 !important;
            background-color: rgba(255, 0, 0, 0.1) !important;
        }
        
        .debug-child-border {
            border: 2px solid #00FF00 !important;
            background-color: rgba(0, 255, 0, 0.1) !important;
        }
        
        .debug-dd-border {
            border: 1px solid #0000FF !important;
            background-color: rgba(0, 0, 255, 0.1) !important;
        }
        
        /* ç§»é™¤æ‰€æœ‰å†…è¾¹è·å’Œå¤–è¾¹è·çš„æµ‹è¯•æ ·å¼ */
        .no-padding {
            padding: 0 !important;
            margin: 0 !important;
        }
        
        .no-padding dd {
            padding: 0 !important;
            margin: 0 !important;
        }
        
        .no-padding dd a {
            padding: 5px 10px !important;
            margin: 0 !important;
        }
    </style>
</head>
<body>
    <!-- è°ƒè¯•é¢æ¿ -->
    <div class="debug-panel">
        <h4>ğŸ” å­èœå•ç»“æ„è°ƒè¯•å·¥å…·</h4>
        
        <div class="debug-buttons">
            <button class="btn-blue" onclick="toggleShrink()">åˆ‡æ¢æ”¶ç¼©</button>
            <button class="btn-red" onclick="forceShowSubmenu()">å¼ºåˆ¶æ˜¾ç¤º</button>
            <button class="btn-green" onclick="showSubmenuWithBorders()">æ˜¾ç¤ºè¾¹ç•Œ</button>
            <button class="btn-orange" onclick="analyzeStructure()">åˆ†æç»“æ„</button>
            <button onclick="testPaddingRemoval()" style="background: #8844FF; color: white; margin: 2px; padding: 4px 8px; border: none; border-radius: 3px; cursor: pointer; font-size: 10px;">ç§»é™¤å†…è¾¹è·</button>
            <button onclick="hideAllSubmenu()" style="background: #666; color: white; margin: 2px; padding: 4px 8px; border: none; border-radius: 3px; cursor: pointer; font-size: 10px;">éšè—æ‰€æœ‰</button>
        </div>
        
        <div id="analysis-result" style="margin-top: 10px; padding: 10px; background: #f5f5f5; border-radius: 3px; font-size: 10px;">
            <strong>åˆ†æç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</strong>
        </div>
        
        <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee; font-size: 10px;">
            <strong>è°ƒè¯•è¯´æ˜ï¼š</strong><br>
            1. ç‚¹å‡»"åˆ‡æ¢æ”¶ç¼©"è®¾ç½®æ”¶ç¼©çŠ¶æ€<br>
            2. ç‚¹å‡»"æ˜¾ç¤ºè¾¹ç•Œ"æŸ¥çœ‹å­èœå•è¾¹ç•Œ<br>
            3. ç‚¹å‡»"åˆ†æç»“æ„"æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯<br>
            4. ç‚¹å‡»"ç§»é™¤å†…è¾¹è·"æµ‹è¯•ä¿®å¤æ–¹æ¡ˆ<br>
            <br>
            <strong>é¢œè‰²è¯´æ˜ï¼š</strong><br>
            ğŸ”´ çº¢è‰²è¾¹æ¡†ï¼šå­èœå•å®¹å™¨(dl)<br>
            ğŸŸ¢ ç»¿è‰²è¾¹æ¡†ï¼šå­èœå•é¡¹(dd)<br>
            ğŸ”µ è“è‰²è¾¹æ¡†ï¼šé“¾æ¥(a)
        </div>
    </div>

    <!-- ä¸»å¸ƒå±€ -->
    <div class="layui-layout layui-layout-admin" id="layout">
        <!-- å¤´éƒ¨ -->
        <div class="layui-header">
            <div class="layui-logo layui-hide-xs layui-bg-black">å­èœå•ç»“æ„è°ƒè¯•</div>
            <ul class="layui-nav layui-layout-left">
                <li class="layui-nav-item">
                    <a href="javascript:;" class="layui-icon layui-icon-spread-left" id="shrink-btn"></a>
                </li>
            </ul>
        </div>
        
        <!-- å·¦ä¾§å¯¼èˆª -->
        <div class="layui-side layui-bg-black">
            <div class="layui-side-scroll">
                <ul class="layui-nav layui-nav-tree" lay-filter="test">
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="layui-icon layui-icon-home"></i>
                            <span>é¦–é¡µ</span>
                        </a>
                    </li>
                    
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="layui-icon layui-icon-user"></i>
                            <span>äººå‘˜ç®¡ç†</span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;">äººå‘˜ä¿¡æ¯</a></dd>
                            <dd><a href="javascript:;">ç®€åŒ–äººå‘˜</a></dd>
                            <dd><a href="javascript:;">éƒ¨é—¨ç®¡ç†</a></dd>
                        </dl>
                    </li>
                    
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="layui-icon layui-icon-util"></i>
                            <span>é£æœºç®¡ç†</span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;">é£æœºä¿¡æ¯</a></dd>
                            <dd><a href="javascript:;">ç»´æŠ¤è®°å½•</a></dd>
                        </dl>
                    </li>
                </ul>
            </div>
        </div>
        
        <!-- å†…å®¹ä¸»ä½“ -->
        <div class="layui-body">
            <div style="padding: 20px; background-color: #f5f5f5; min-height: 100vh;">
                <div style="background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h2>å­èœå•ç»“æ„é—®é¢˜è°ƒè¯•</h2>
                    <p>è¿™ä¸ªé¡µé¢ä¸“é—¨ç”¨äºè°ƒè¯•å­èœå•ç¬¬ä¸€ä¸ªé€‰é¡¹ä½ç½®åç§»çš„é—®é¢˜ã€‚</p>
                    
                    <h3>é—®é¢˜æè¿°ï¼š</h3>
                    <p>å­èœå•çš„ç¬¬ä¸€ä¸ªé€‰é¡¹æ€»æ˜¯åœ¨å›¾æ ‡ä¸‹æ–¹42åƒç´ çš„ä½ç½®ï¼Œå°±åƒä¸Šæ–¹æœ‰ä¸€ä¸ªéšè—çš„ç©ºç™½èœå•é¡¹ã€‚</p>
                    
                    <h3>å¯èƒ½çš„åŸå› ï¼š</h3>
                    <ul>
                        <li>å­èœå•å®¹å™¨(dl)æœ‰å†…è¾¹è·</li>
                        <li>ç¬¬ä¸€ä¸ªå­èœå•é¡¹(dd)æœ‰å¤–è¾¹è·</li>
                        <li>layuiæ¡†æ¶çš„é»˜è®¤æ ·å¼å½±å“</li>
                        <li>CSSçš„ç›’æ¨¡å‹è®¡ç®—é—®é¢˜</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="wwwroot/lib/jquery/dist/jquery.min.js"></script>
    <script src="wwwroot/lib/layui/layui.js"></script>
    
    <script>
        function toggleShrink() {
            var $layout = $('#layout');
            $layout.toggleClass('layui-layout-shrink');
            console.log('åˆ‡æ¢æ”¶ç¼©çŠ¶æ€');
        }

        function forceShowSubmenu() {
            console.log('=== å¼ºåˆ¶æ˜¾ç¤ºå­èœå• ===');

            $('.layui-nav-child').each(function(index) {
                var $child = $(this);
                var $item = $child.closest('.layui-nav-item');
                var $link = $item.find('> a');
                var linkOffset = $link.offset();
                var sidebarWidth = $('.layui-side').outerWidth();

                // å¼ºåˆ¶æ˜¾ç¤ºå­èœå•
                $child.addClass('show-submenu');
                $child.css({
                    'position': 'fixed',
                    'left': sidebarWidth + 'px',
                    'top': linkOffset.top + 'px',
                    'z-index': '99999',
                    'background-color': '#2F4056'
                });

                console.log('å­èœå• ' + index + ' å·²å¼ºåˆ¶æ˜¾ç¤º:', {
                    menuText: $item.find('span').text(),
                    linkOffset: linkOffset,
                    sidebarWidth: sidebarWidth
                });
            });

            $('#analysis-result').html('<strong>å·²å¼ºåˆ¶æ˜¾ç¤ºå­èœå•</strong><br>è§‚å¯Ÿå­èœå•ç¬¬ä¸€ä¸ªé€‰é¡¹çš„ä½ç½®');
        }
        
        function showSubmenuWithBorders() {
            console.log('=== æ˜¾ç¤ºå­èœå•è¾¹ç•Œ ===');

            $('.layui-nav-child').each(function(index) {
                var $child = $(this);
                var $item = $child.closest('.layui-nav-item');
                var $link = $item.find('> a');
                var linkOffset = $link.offset();
                var sidebarWidth = $('.layui-side').outerWidth();

                // æ˜¾ç¤ºå­èœå•å¹¶æ·»åŠ è¾¹ç•Œ
                $child.addClass('show-submenu debug-border');
                $child.css({
                    'position': 'fixed',
                    'left': sidebarWidth + 'px',
                    'top': linkOffset.top + 'px',
                    'z-index': '99999',
                    'background-color': '#2F4056',
                    'border': '3px solid #FF0000' // å¼ºåˆ¶çº¢è‰²è¾¹æ¡†
                });

                // ä¸ºæ¯ä¸ªddæ·»åŠ è¾¹ç•Œ
                $child.find('dd').each(function() {
                    $(this).css({
                        'border': '2px solid #00FF00',
                        'background-color': 'rgba(0, 255, 0, 0.1)'
                    });
                });

                // ä¸ºæ¯ä¸ªé“¾æ¥æ·»åŠ è¾¹ç•Œ
                $child.find('dd a').each(function() {
                    $(this).css({
                        'border': '1px solid #0000FF',
                        'background-color': 'rgba(0, 0, 255, 0.1)'
                    });
                });

                console.log('å­èœå• ' + index + ' è¾¹ç•Œå·²æ˜¾ç¤º:', {
                    menuText: $item.find('span').text(),
                    childElement: $child[0],
                    ddCount: $child.find('dd').length
                });
            });

            $('#analysis-result').html('<strong>è¾¹ç•Œå·²æ˜¾ç¤º</strong><br>ğŸ”´ çº¢è‰²ï¼šå­èœå•å®¹å™¨<br>ğŸŸ¢ ç»¿è‰²ï¼šèœå•é¡¹<br>ğŸ”µ è“è‰²ï¼šé“¾æ¥');
        }
        
        function analyzeStructure() {
            console.log('=== åˆ†æå­èœå•ç»“æ„ ===');
            var analysis = [];
            
            $('.layui-nav-child').each(function(index) {
                var $child = $(this);
                var $item = $child.closest('.layui-nav-item');
                var $firstDD = $child.find('dd:first');
                var $firstLink = $firstDD.find('a');
                
                // è·å–å„ç§å°ºå¯¸å’Œä½ç½®ä¿¡æ¯
                var childStyles = window.getComputedStyle($child[0]);
                var ddStyles = window.getComputedStyle($firstDD[0]);
                var linkStyles = window.getComputedStyle($firstLink[0]);
                
                var info = {
                    menuText: $item.find('span').text(),
                    childPadding: {
                        top: childStyles.paddingTop,
                        bottom: childStyles.paddingBottom,
                        left: childStyles.paddingLeft,
                        right: childStyles.paddingRight
                    },
                    childMargin: {
                        top: childStyles.marginTop,
                        bottom: childStyles.marginBottom,
                        left: childStyles.marginLeft,
                        right: childStyles.marginRight
                    },
                    ddPadding: {
                        top: ddStyles.paddingTop,
                        bottom: ddStyles.paddingBottom
                    },
                    ddMargin: {
                        top: ddStyles.marginTop,
                        bottom: ddStyles.marginBottom
                    },
                    linkPadding: {
                        top: linkStyles.paddingTop,
                        bottom: linkStyles.paddingBottom
                    },
                    linkMargin: {
                        top: linkStyles.marginTop,
                        bottom: linkStyles.marginBottom
                    },
                    childHeight: $child.outerHeight(),
                    firstDDHeight: $firstDD.outerHeight(),
                    firstLinkHeight: $firstLink.outerHeight()
                };
                
                analysis.push(info);
                console.log('å­èœå• ' + index + ' ç»“æ„åˆ†æ:', info);
            });
            
            // æ˜¾ç¤ºåˆ†æç»“æœ
            var resultHtml = '<strong>ç»“æ„åˆ†æç»“æœï¼š</strong><br>';
            analysis.forEach(function(info, index) {
                resultHtml += '<div style="margin: 5px 0; padding: 5px; background: #fff; border-radius: 2px;">';
                resultHtml += '<strong>' + info.menuText + ':</strong><br>';
                resultHtml += 'dlå®¹å™¨padding-top: ' + info.childPadding.top + '<br>';
                resultHtml += 'ddé¡¹margin-top: ' + info.ddMargin.top + '<br>';
                resultHtml += 'aé“¾æ¥padding-top: ' + info.linkPadding.top + '<br>';
                resultHtml += '</div>';
            });
            
            $('#analysis-result').html(resultHtml);
        }
        
        function testPaddingRemoval() {
            console.log('=== æµ‹è¯•ç§»é™¤å†…è¾¹è· ===');
            
            $('.layui-nav-child').each(function(index) {
                var $child = $(this);
                var $item = $child.closest('.layui-nav-item');
                var $link = $item.find('> a');
                var linkOffset = $link.offset();
                var sidebarWidth = $('.layui-side').outerWidth();
                
                // æ·»åŠ ç§»é™¤å†…è¾¹è·çš„ç±»
                $child.addClass('show-submenu no-padding');
                $child.css({
                    'position': 'fixed',
                    'left': sidebarWidth + 'px',
                    'top': linkOffset.top + 'px',
                    'z-index': '99999',
                    'background-color': '#2F4056',
                    'border': '2px solid #FF0000'
                });
                
                console.log('å­èœå• ' + index + ' å·²ç§»é™¤å†…è¾¹è·');
            });
            
            $('#analysis-result').html('<strong>å·²ç§»é™¤æ‰€æœ‰å†…è¾¹è·å’Œå¤–è¾¹è·</strong><br>è§‚å¯Ÿå­èœå•ç¬¬ä¸€ä¸ªé€‰é¡¹çš„ä½ç½®æ˜¯å¦æ”¹å–„');
        }
        
        function hideAllSubmenu() {
            $('.layui-nav-child').removeClass('show-submenu debug-border no-padding');
            $('.layui-nav-child').css({
                'border': '',
                'background-color': '',
                'position': '',
                'left': '',
                'top': '',
                'z-index': ''
            });

            $('.layui-nav-child dd').removeClass('debug-child-border').css({
                'border': '',
                'background-color': ''
            });

            $('.layui-nav-child dd a').removeClass('debug-dd-border').css({
                'border': '',
                'background-color': ''
            });

            $('#analysis-result').html('<strong>å·²éšè—æ‰€æœ‰å­èœå•å’Œè¾¹ç•Œ</strong>');
            console.log('éšè—æ‰€æœ‰å­èœå•');
        }

        // åˆå§‹åŒ–
        layui.use('element', function(){
            var element = layui.element;
            
            $(document).ready(function() {
                // ç»‘å®šæ”¶ç¼©æŒ‰é’®
                $('#shrink-btn').click(function() {
                    toggleShrink();
                });
                
                console.log('å­èœå•ç»“æ„è°ƒè¯•é¡µé¢åˆå§‹åŒ–å®Œæˆ');
            });
        });
    </script>
</body>
</html>
